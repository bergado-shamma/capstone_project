/// <reference path="../pb_data/types.d.ts" />
migrate((app) => {
  const collection = app.findCollectionByNameOrId("_pb_users_auth_")

  // update collection data
  unmarshal({
    "resetPasswordTemplate": {
      "body": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Password Reset - {APP_NAME}</title>\n    <style>\n        /* General Body Styles */\n        body {\n            font-family: 'Montserrat', 'Inter', sans-serif;\n            line-height: 1.6;\n            color: #ffffff;\n            margin: 0;\n            padding: 0;\n            background-color: #f8f9fa;\n        }\n        /* Container for the email content */\n        .email-container {\n            max-width: 600px;\n            margin: 20px auto;\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n            overflow: hidden;\n            border: 1px solid #e0e0e0;\n        }\n        /* Header Section - 100% Opaque PUP Maroon */\n        .header {\n            background-color: #800000; /* PUP Maroon at 100% opacity */\n            color: #ffffff;\n            padding: 30px 25px;\n            text-align: center;\n            font-size: 28px;\n            font-weight: 800;\n            letter-spacing: 1px;\n            border-bottom: 3px solid #ffffff; /* Solid white line below the header */\n            line-height: 1.2;\n        }\n        /* Content Body Section - 100% Opaque Very Dark Maroon */\n        .content-body {\n            background-color: #260000; /* Very dark maroon/brown shade at 100% opacity */\n            color: #ffffff;\n            padding: 30px 25px;\n        }\n        /* Paragraph styles */\n        p {\n            margin-bottom: 15px;\n            font-size: 16px;\n            color: #ffffff;\n        }\n        /* Button Styling - Remains fully opaque for clarity */\n        .button-container {\n            text-align: center;\n            margin-top: 35px;\n            margin-bottom: 35px;\n        }\n        .button {\n            display: inline-block;\n            padding: 15px 30px;\n            background-color: #800000; /* PUP Maroon (fully opaque) */\n            color: #ffffff !important;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 18px;\n            font-weight: bold;\n            transition: background-color 0.3s ease;\n            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n        }\n        .button:hover {\n            background-color: #660000; /* Darker maroon on hover (fully opaque) */\n        }\n        /* Footer Section */\n        .footer {\n            background-color: #f2f2f2;\n            color: #777777;\n            padding: 20px 25px;\n            font-size: 13px;\n            text-align: center;\n            border-top: 1px solid #e0e0e0;\n            border-bottom-left-radius: 12px;\n            border-bottom-right-radius: 12px;\n        }\n        .footer p {\n            margin: 5px 0;\n            color: #777777;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        <div class=\"header\">\n            {APP_NAME}\n        </div>\n        <div class=\"content-body\">\n            <p>Dear PUPTian,</p>\n            <p>We received a request to reset the password for your account with **{APP_NAME}**.</p>\n            <p>If you initiated this request, please click the button below to proceed with setting a new password:</p>\n            <div class=\"button-container\">\n                <a class=\"button\" href=\"{APP_URL}/_/#/auth/confirm-password-reset/{TOKEN}\" target=\"_blank\" rel=\"noopener\">Reset Your Password</a>\n            </div>\n            <p>This password reset link is valid for a limited time. For your security, please complete the process promptly.</p>\n            <p>If you did not request a password reset, please disregard this email. Your account remains secure.</p>\n            <p>Sincerely,</p>\n            <p>The {APP_NAME} Team</p>\n        </div>\n        <div class=\"footer\">\n            <p>&copy; 2025 {APP_NAME}. All rights reserved.</p>\n            <p>This is an automated email; please do not reply directly.</p>\n        </div>\n    </div>\n</body>\n</html>"
    }
  }, collection)

  return app.save(collection)
}, (app) => {
  const collection = app.findCollectionByNameOrId("_pb_users_auth_")

  // update collection data
  unmarshal({
    "resetPasswordTemplate": {
      "body": "<p>Hello,</p>\n<p>Click on the button below to reset your password.</p>\n<p>\n  <a class=\"btn\" href=\"{APP_URL}/_/#/auth/confirm-password-reset/{TOKEN}\" target=\"_blank\" rel=\"noopener\">Reset password</a>\n</p>\n<p><i>If you didn't ask to reset your password, you can ignore this email.</i></p>\n<p>\n  Thanks,<br/>\n  {APP_NAME} team\n</p>"
    }
  }, collection)

  return app.save(collection)
})
